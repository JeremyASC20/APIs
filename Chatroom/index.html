<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="chatroomstyle.css">
    <script src="sketch.js" defer></script>
    <link rel="icon" type="image/jfif" href="images/logo copy.jfif">
    <link href="https://fonts.googleapis.com/css2?family=Recursive:wght@900&display=swap" rel="stylesheet">
    <title>Chatroom</title>
</head>
<body>
    <a href="../index.html"><img id="homelogo" src="images/logo copy.jfif"></a>

    <div id="beforeDiv">
    <div id="chatroomtitle">Chatroom</div>
    <div id="before_login">
        <form>
            Username: <input type="text" id="username_textbox">
            <button id="save"> Save Username</button>
        </form>
    </div>
    </div>

    <div id="after_login">
        <div id="buttonChoice">
        <button id="discriminationButton">Discrimination</button>            
        <button id="environmentalButton">Environmental</button>            
        <button id="currentButton">Current Events</button>
        <button id="pandemicButton">Pandemic</button>
        </div>
        <div id="chatroomname">Discrimination Chatroom</div>        <div id="discriminationChatroom"></div>
        <div id="environmentalChatroom"></div>
        <div id="currentChatroom"></div>
        <div id="pandemicChatroom"></div>
                <br><br>
        <form>
            <input type="text" id="Duser_chat">
            <button id="discriminationSubmit">Submit Chat</button>
        </form>

        <form>
            <input type="text" id="Puser_chat">
            <button id="pandemicSubmit">Submit Chat</button>
        </form>

        <form>
            <input type="text" id="Euser_chat">
            <button id="environmentalSubmit">Submit Chat</button>
        </form>

        <form>
            <input type="text" id="Cuser_chat">
            <button id="currentSubmit">Submit Chat</button>
        </form>

    </div>

    <script src="https://www.gstatic.com/firebasejs/7.13.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.13.0/firebase-firestore.memory.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.13.0/firebase-auth.js"></script>
  
    <script>
      // ADD YOUR firebaseConfig HERE
            const firebaseConfig = {
            apiKey: "AIzaSyALOepA8XsGGE5jt2NJ1sVEqVmB4o03eKk",
            authDomain: "apis-b486c.firebaseapp.com",
            databaseURL: "https://apis-b486c.firebaseio.com",
            projectId: "apis-b486c",
            storageBucket: "apis-b486c.appspot.com",
            messagingSenderId: "564911288227",
            appId: "1:564911288227:web:abd143eda2fba44861b416",
            measurementId: "G-FR6TQ432KE"
            };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);

        // initialize connection to our database

        let db = firebase.firestore();
        console.log("Success!")

        // get references
        

        let chatroomnameDiv = document.getElementById("chatroomname");        
        let discriminationButton = document.getElementById("discriminationButton");
        let environmentalButton = document.getElementById("environmentalButton");
        let currentButton = document.getElementById("currentButton");
        let pandemicButton = document.getElementById("pandemicButton");
        let DuserInputTextbox = document.getElementById("Duser_chat");
        let EuserInputTextbox = document.getElementById("Euser_chat");
        let PuserInputTextbox = document.getElementById("Puser_chat");
        let CuserInputTextbox = document.getElementById("Cuser_chat");
        let discriminationsubmitButton = document.getElementById("discriminationSubmit");
        let pandemicsubmitButton = document.getElementById("pandemicSubmit");
        let environmentalsubmitButton = document.getElementById("environmentalSubmit");
        let currentsubmitButton = document.getElementById("currentSubmit");
        let chatroomDiv = document.getElementById("chatroom");
        let discriminationChatroomDiv = document.getElementById("discriminationChatroom");
        let environmentalChatroomDiv = document.getElementById("environmentalChatroom");
        let currentChatroomDiv = document.getElementById("currentChatroom");
        let pandemicChatroomDiv = document.getElementById("pandemicChatroom");
        let usernameTextbox = document.getElementById("username_textbox");
        let saveButton = document.getElementById("save");
        let beforeLoginDiv = document.getElementById("before_login");
        let afterLoginDiv = document.getElementById("after_login");

        afterLoginDiv.style.display = "none";
        beforeLoginDiv.style.display = "flex";
        discriminationChatroomDiv.style.display = "flex";
        environmentalChatroomDiv.style.display = "none";
        currentChatroomDiv.style.display = "none";
        pandemicChatroomDiv.style.display = "none";
        discriminationsubmitButton.style.display = "flex";
        pandemicsubmitButton.style.display = "none";
        environmentalsubmitButton.style.display = "none";
        currentsubmitButton.style.display = "none";
        DuserInputTextbox.style.display = "flex";
        EuserInputTextbox.style.display = "none";
        PuserInputTextbox.style.display = "none";
        CuserInputTextbox.style.display = "none";
        

        let username;

        saveButton.onclick = function(event) {
            event.preventDefault()
            username = usernameTextbox.value
            console.log(username)

        // hide beforeLogin and show afterLogin

            beforeLoginDiv.style.display = "none"
            afterLoginDiv.style.display = "flex"
        }

        discriminationButton.onclick = function() {
            discriminationChatroomDiv.style.display = "flex";
            environmentalChatroomDiv.style.display = "none";
            currentChatroomDiv.style.display = "none";
            pandemicChatroomDiv.style.display = "none";
            discriminationsubmitButton.style.display = "flex";
            pandemicsubmitButton.style.display = "none";
            environmentalsubmitButton.style.display = "none";
            currentsubmitButton.style.display = "none";
            DuserInputTextbox.style.display = "flex";
            EuserInputTextbox.style.display = "none";
            PuserInputTextbox.style.display = "none";
            CuserInputTextbox.style.display = "none";


            chatroomnameDiv.innerHTML = "Discrimination Chatroom"        
        }

        environmentalButton.onclick = function() {
            discriminationChatroomDiv.style.display = "none";
            environmentalChatroomDiv.style.display = "flex";
            currentChatroomDiv.style.display = "none";
            pandemicChatroomDiv.style.display = "none";
            discriminationsubmitButton.style.display = "none";
            pandemicsubmitButton.style.display = "none";
            environmentalsubmitButton.style.display = "flex";
            currentsubmitButton.style.display = "none";
            DuserInputTextbox.style.display = "none";
            EuserInputTextbox.style.display = "flex";
            PuserInputTextbox.style.display = "none";
            CuserInputTextbox.style.display = "none";


            chatroomnameDiv.innerHTML = "Environmental Chatroom"        
        }

        currentButton.onclick = function() {
            discriminationChatroomDiv.style.display = "none";
            environmentalChatroomDiv.style.display = "none";
            currentChatroomDiv.style.display = "flex";
            pandemicChatroomDiv.style.display = "none";
            discriminationsubmitButton.style.display = "none";
            pandemicsubmitButton.style.display = "none";
            environmentalsubmitButton.style.display = "none";
            currentsubmitButton.style.display = "flex";
            DuserInputTextbox.style.display = "none";
            EuserInputTextbox.style.display = "none";
            PuserInputTextbox.style.display = "none";
            CuserInputTextbox.style.display = "flex";


            chatroomnameDiv.innerHTML = "Current Chatroom"
        }

        pandemicButton.onclick = function() {
            discriminationChatroomDiv.style.display = "none";
            environmentalChatroomDiv.style.display = "none";
            currentChatroomDiv.style.display = "none";
            pandemicChatroomDiv.style.display = "flex";
            discriminationsubmitButton.style.display = "none";
            pandemicsubmitButton.style.display = "flex";
            environmentalsubmitButton.style.display = "none";
            currentsubmitButton.style.display = "none";
            DuserInputTextbox.style.display = "none";
            EuserInputTextbox.style.display = "none";
            PuserInputTextbox.style.display = "flex";
            CuserInputTextbox.style.display = "none";


            chatroomnameDiv.innerHTML = "Pandemic Chatroom"        
        }

        discriminationsubmitButton.onclick = function(event) {
            event.preventDefault()

            //time
            
            let now = new Date()
            let timestamp = new Date().getTime()
            console.log(now)
            console.log(timestamp)

            // save data to database
            db.collection("discriminationchatroom").add({
                "username": username,
                "discriminationChat": DuserInputTextbox.value,
                "timestamp": timestamp
            })

            DuserInputTextbox.value = ""
            CuserInputTextbox.value = ""
            EuserInputTextbox.value = ""
            PuserInputTextbox.value = ""

        }

        environmentalsubmitButton.onclick = function(event) {
            event.preventDefault()

            //time
            
            let now = new Date()
            let timestamp = new Date().getTime()
            console.log(now)
            console.log(timestamp)

            // save data to database
            db.collection("environmentalchatroom").add({
                "username": username,
                "environmentalChat": EuserInputTextbox.value,
                "timestamp": timestamp
            })


            DuserInputTextbox.value = ""
            CuserInputTextbox.value = ""
            EuserInputTextbox.value = ""
            PuserInputTextbox.value = ""

        }

        pandemicsubmitButton.onclick = function(event) {
            event.preventDefault()

            //time
            
            let now = new Date()
            let timestamp = new Date().getTime()
            console.log(now)
            console.log(timestamp)

            // save data to database
            db.collection("pandemicchatroom").add({
                "username": username,
                "pandemicChat": PuserInputTextbox.value,
                "timestamp": timestamp
            })


            DuserInputTextbox.value = ""
            CuserInputTextbox.value = ""
            EuserInputTextbox.value = ""
            PuserInputTextbox.value = ""

        }

        currentsubmitButton.onclick = function(event) {
            event.preventDefault()

            //time
            
            let now = new Date()
            let timestamp = new Date().getTime()
            console.log(now)
            console.log(timestamp)

            // save data to database
            db.collection("currentchatroom").add({
                "username": username,
                "currentChat": CuserInputTextbox.value,
                "timestamp": timestamp
            })


            DuserInputTextbox.value = ""
            CuserInputTextbox.value = ""
            EuserInputTextbox.value = ""
            PuserInputTextbox.value = ""

        }


        db.collection("discriminationchatroom").orderBy("timestamp").onSnapshot(function(snapshot) {
        
        discriminationChatroomDiv.innerHTML = ""
        for (let i = 0; i < snapshot.docs.length; i++) {
            discriminationChatroomDiv.innerHTML += snapshot.docs[i].data().username + ": ",
            discriminationChatroomDiv.innerHTML += snapshot.docs[i].data().discriminationChat + "<br>"
        }
        })

        db.collection("environmentalchatroom").orderBy("timestamp").onSnapshot(function(snapshot) {
        
        environmentalChatroomDiv.innerHTML = ""
        for (let i = 0; i < snapshot.docs.length; i++) {
            environmentalChatroomDiv.innerHTML += snapshot.docs[i].data().username + ": ",
            environmentalChatroomDiv.innerHTML += snapshot.docs[i].data().environmentalChat + "<br>"
        }
        })

        db.collection("pandemicchatroom").orderBy("timestamp").onSnapshot(function(snapshot) {
        
        pandemicChatroomDiv.innerHTML = ""
        for (let i = 0; i < snapshot.docs.length; i++) {
            pandemicChatroomDiv.innerHTML += snapshot.docs[i].data().username + ": ",
            pandemicChatroomDiv.innerHTML += snapshot.docs[i].data().pandemicChat + "<br>"
        }
        })
    
        db.collection("currentchatroom").orderBy("timestamp").onSnapshot(function(snapshot) {
        
        currentChatroomDiv.innerHTML = ""
        for (let i = 0; i < snapshot.docs.length; i++) {
            currentChatroomDiv.innerHTML += snapshot.docs[i].data().username + ": ",
            currentChatroomDiv.innerHTML += snapshot.docs[i].data().currentChat + "<br>"
        }
        })

        </script>

</body>
</html>